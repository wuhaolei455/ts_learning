# EventEmitter TDD å­¦ä¹ é¡¹ç›®

## ğŸ¯ é¡¹ç›®ç®€ä»‹

è¿™æ˜¯ä¸€ä¸ªåŸºäºæµ‹è¯•é©±åŠ¨å¼€å‘ï¼ˆTDDï¼‰æ–¹æ³•çš„ EventEmitter å­¦ä¹ é¡¹ç›®ã€‚é€šè¿‡å››ä¸ªé€’è¿›çš„é˜¶æ®µï¼Œä½ å°†ä»é›¶å¼€å§‹å®ç°ä¸€ä¸ªå®Œæ•´çš„äº‹ä»¶å‘å°„å™¨ç³»ç»Ÿã€‚

## ğŸ“ é¡¹ç›®ç»“æ„

```
tdd/
â”œâ”€â”€ test-framework.ts           # è‡ªå®šä¹‰æµ‹è¯•æ¡†æ¶
â”œâ”€â”€ 01-basic-event-emitter.test.ts      # ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€åŠŸèƒ½æµ‹è¯•
â”œâ”€â”€ 02-improved-event-emitter.test.ts   # ç¬¬äºŒé˜¶æ®µï¼šæ”¹è¿›åŠŸèƒ½æµ‹è¯•
â”œâ”€â”€ 03-typed-event-emitter.test.ts      # ç¬¬ä¸‰é˜¶æ®µï¼šç±»å‹å®‰å…¨æµ‹è¯•
â”œâ”€â”€ 04-async-event-emitter.test.ts      # ç¬¬å››é˜¶æ®µï¼šå¼‚æ­¥åŠŸèƒ½æµ‹è¯•
â”œâ”€â”€ run-all-tests.ts            # è¿è¡Œæ‰€æœ‰æµ‹è¯•çš„å…¥å£
â”œâ”€â”€ TDDå­¦ä¹ æŒ‡å—.md              # è¯¦ç»†å­¦ä¹ æŒ‡å—
â”œâ”€â”€ README.md                   # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â””â”€â”€ solutions/                  # å‚è€ƒç­”æ¡ˆç›®å½•
    â”œâ”€â”€ 01-basic-solution.ts
    â”œâ”€â”€ 02-improved-solution.ts
    â”œâ”€â”€ 03-typed-solution.ts
    â””â”€â”€ 04-async-solution.ts
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. è¿è¡Œå•ä¸ªé˜¶æ®µæµ‹è¯•

```bash
# ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€EventEmitter
npx ts-node --files src/event-emitter/tdd/01-basic-event-emitter.test.ts

# ç¬¬äºŒé˜¶æ®µï¼šæ”¹è¿›ç‰ˆEventEmitter
npx ts-node --files src/event-emitter/tdd/02-improved-event-emitter.test.ts

# ç¬¬ä¸‰é˜¶æ®µï¼šç±»å‹å®‰å…¨EventEmitter
npx ts-node --files src/event-emitter/tdd/03-typed-event-emitter.test.ts

# ç¬¬å››é˜¶æ®µï¼šå¼‚æ­¥EventEmitter
npx ts-node --files src/event-emitter/tdd/04-async-event-emitter.test.ts
```

### 2. è¿è¡Œæ‰€æœ‰æµ‹è¯•

```bash
npx ts-node --files src/event-emitter/tdd/run-all-tests.ts
```

### 3. æŸ¥çœ‹å‚è€ƒç­”æ¡ˆ

```bash
# è¿è¡Œå‚è€ƒå®ç°
npx ts-node --files src/event-emitter/tdd/solutions/01-basic-solution.ts
npx ts-node --files src/event-emitter/tdd/solutions/02-improved-solution.ts
npx ts-node --files src/event-emitter/tdd/solutions/03-typed-solution.ts
npx ts-node --files src/event-emitter/tdd/solutions/04-async-solution.ts
```

## ğŸ“š å­¦ä¹ é˜¶æ®µ

### ğŸŸ¡ ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€ EventEmitter

**ç›®æ ‡**: å®ç°æœ€åŸºæœ¬çš„äº‹ä»¶ç³»ç»Ÿ

- âœ… æ·»åŠ äº‹ä»¶ç›‘å¬å™¨ (`on`)
- âœ… è§¦å‘äº‹ä»¶ (`emit`)
- âœ… è·å–ç›‘å¬å™¨æ•°é‡ (`listenerCount`)
- âœ… å¤„ç†å¤šä¸ªç›‘å¬å™¨å’Œå‚æ•°ä¼ é€’

### ğŸŸ  ç¬¬äºŒé˜¶æ®µï¼šæ”¹è¿›ç‰ˆ EventEmitter

**ç›®æ ‡**: æ·»åŠ è®¢é˜…ç®¡ç†å’Œæ€§èƒ½ä¼˜åŒ–

- âœ… è®¢é˜…/å–æ¶ˆè®¢é˜…æ¨¡å¼ (`subscribe`/`unsubscribe`)
- âœ… ä½¿ç”¨ Map å’Œ Set ä¼˜åŒ–æ€§èƒ½
- âœ… é”™è¯¯å¤„ç†å’Œè¿”å›å€¼æ”¶é›†
- âœ… æ‰¹é‡æ“ä½œå’Œç›‘å¬å™¨ç®¡ç†

### ğŸ”µ ç¬¬ä¸‰é˜¶æ®µï¼šç±»å‹å®‰å…¨ EventEmitter

**ç›®æ ‡**: å®ç°ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥

- âœ… æ³›å‹çº¦æŸå’Œç±»å‹å®‰å…¨
- âœ… é“¾å¼è°ƒç”¨æ”¯æŒ
- âœ… ä¸€æ¬¡æ€§ç›‘å¬å™¨ (`once`)
- âœ… ç±»å‹å®‰å…¨çš„ç›‘å¬å™¨æ“ä½œ

### ğŸŸ¢ ç¬¬å››é˜¶æ®µï¼šå¼‚æ­¥ EventEmitter

**ç›®æ ‡**: æ”¯æŒå¼‚æ­¥ç›‘å¬å™¨

- âœ… å¼‚æ­¥ç›‘å¬å™¨æ”¯æŒ
- âœ… å¹¶è¡Œæ‰§è¡Œ (`emitAsync`)
- âœ… ä¸²è¡Œæ‰§è¡Œ (`emitAsyncSerial`)
- âœ… å¼‚æ­¥é”™è¯¯å¤„ç†

## ğŸ§ª æµ‹è¯•æ¡†æ¶ç‰¹æ€§

### æ–­è¨€æ–¹æ³•

- `Assert.equal(actual, expected)` - ç›¸ç­‰æ–­è¨€
- `Assert.true(value)` / `Assert.false(value)` - å¸ƒå°”æ–­è¨€
- `Assert.deepEqual(actual, expected)` - æ·±åº¦ç›¸ç­‰æ–­è¨€
- `Assert.arrayContains(array, item)` - æ•°ç»„åŒ…å«æ–­è¨€
- `Assert.greaterThan(a, b)` / `Assert.lessThan(a, b)` - æ•°å€¼æ¯”è¾ƒæ–­è¨€

### æ¨¡æ‹Ÿå‡½æ•° (Mock)

- `createMock<T>()` - åˆ›å»ºæ¨¡æ‹Ÿå‡½æ•°
- `mock.toHaveBeenCalled()` - æ£€æŸ¥æ˜¯å¦è¢«è°ƒç”¨
- `mock.toHaveBeenCalledTimes(n)` - æ£€æŸ¥è°ƒç”¨æ¬¡æ•°
- `mock.toHaveBeenCalledWith(...args)` - æ£€æŸ¥è°ƒç”¨å‚æ•°
- `mock.getCallArgs(index)` - è·å–æŒ‡å®šè°ƒç”¨çš„å‚æ•°

## ğŸ’¡ å­¦ä¹ å»ºè®®

### 1. æŒ‰é˜¶æ®µè¿›è¡Œ

- ä»ç¬¬ä¸€é˜¶æ®µå¼€å§‹ï¼Œé€æ­¥å®Œæˆæ¯ä¸ªé˜¶æ®µ
- ç¡®ä¿å½“å‰é˜¶æ®µæ‰€æœ‰æµ‹è¯•é€šè¿‡å†è¿›å…¥ä¸‹ä¸€é˜¶æ®µ
- ç†è§£æ¯ä¸ªåŠŸèƒ½çš„è®¾è®¡æ€è·¯å’Œå®ç°æ–¹å¼

### 2. TDD æµç¨‹

1. **çº¢ï¼ˆRedï¼‰**: è¿è¡Œæµ‹è¯•ï¼Œçœ‹åˆ°å¤±è´¥
2. **ç»¿ï¼ˆGreenï¼‰**: ç¼–å†™æœ€ç®€ä»£ç è®©æµ‹è¯•é€šè¿‡
3. **é‡æ„ï¼ˆRefactorï¼‰**: ä¼˜åŒ–ä»£ç ç»“æ„

### 3. å®ç°ç­–ç•¥

- å…ˆå®ç°åŠŸèƒ½ï¼Œå†è€ƒè™‘æ€§èƒ½
- é‡è§†é”™è¯¯å¤„ç†å’Œè¾¹ç•Œæƒ…å†µ
- ä¿æŒä»£ç ç®€æ´å’Œå¯è¯»æ€§

### 4. è°ƒè¯•æŠ€å·§

- ä½¿ç”¨ `console.log` è¾“å‡ºä¸­é—´çŠ¶æ€
- å•ç‹¬è¿è¡Œå¤±è´¥çš„æµ‹è¯•è¿›è¡Œè°ƒè¯•
- ä»”ç»†é˜…è¯»æµ‹è¯•æè¿°ç†è§£éœ€æ±‚

## ğŸ” å¸¸è§é—®é¢˜

### Q: æµ‹è¯•å¤±è´¥æ€ä¹ˆåŠï¼Ÿ

1. ä»”ç»†é˜…è¯»é”™è¯¯ä¿¡æ¯å’Œæµ‹è¯•æè¿°
2. æ£€æŸ¥å®ç°é€»è¾‘æ˜¯å¦æ­£ç¡®
3. ä½¿ç”¨è°ƒè¯•å·¥å…·å®šä½é—®é¢˜
4. å‚è€ƒæµ‹è¯•ç”¨ä¾‹ç†è§£æœŸæœ›è¡Œä¸º

### Q: TypeScript ç±»å‹é”™è¯¯å¦‚ä½•è§£å†³ï¼Ÿ

1. ç†è§£æ³›å‹çº¦æŸçš„ä½œç”¨
2. ç¡®ä¿æ¥å£å®šä¹‰æ­£ç¡®
3. æ£€æŸ¥æ–¹æ³•ç­¾åæ˜¯å¦åŒ¹é…
4. ä½¿ç”¨ IDE çš„ç±»å‹æç¤ºåŠŸèƒ½

### Q: å¼‚æ­¥æµ‹è¯•å¦‚ä½•ç†è§£ï¼Ÿ

1. åŒºåˆ†å¹¶è¡Œå’Œä¸²è¡Œæ‰§è¡Œçš„å·®å¼‚
2. ç†è§£ Promise.all å’Œ for å¾ªç¯çš„åŒºåˆ«
3. æ³¨æ„å¼‚æ­¥é”™è¯¯å¤„ç†çš„é‡è¦æ€§
4. æŒæ¡ async/await çš„ä½¿ç”¨æ–¹æ³•

## ğŸ“ å­¦ä¹ æˆæœ

å®Œæˆæ‰€æœ‰é˜¶æ®µåï¼Œä½ å°†æŒæ¡ï¼š

- âœ… æµ‹è¯•é©±åŠ¨å¼€å‘çš„åŸºæœ¬æµç¨‹å’Œæ€ç»´
- âœ… EventEmitter çš„è®¾è®¡åŸç†å’Œå®ç°ç»†èŠ‚
- âœ… TypeScript æ³›å‹å’Œç±»å‹ç³»ç»Ÿçš„é«˜çº§ç”¨æ³•
- âœ… å¼‚æ­¥ç¼–ç¨‹å’Œ Promise çš„å¤„ç†æŠ€å·§
- âœ… é”™è¯¯å¤„ç†å’Œè¾¹ç•Œæƒ…å†µçš„è€ƒè™‘æ–¹æ³•
- âœ… ä»£ç é‡æ„å’Œæ€§èƒ½ä¼˜åŒ–çš„å®è·µç»éªŒ

## ğŸ“ è·å–å¸®åŠ©

å¦‚æœåœ¨å­¦ä¹ è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š

1. æŸ¥çœ‹ `TDDå­¦ä¹ æŒ‡å—.md` è·å–è¯¦ç»†è¯´æ˜
2. å‚è€ƒ `solutions/` ç›®å½•ä¸­çš„å‚è€ƒç­”æ¡ˆ
3. ç†è§£æµ‹è¯•ç”¨ä¾‹çš„æœŸæœ›è¡Œä¸º
4. é€æ­¥è°ƒè¯•å’ŒéªŒè¯ä½ çš„å®ç°

å¼€å§‹ä½ çš„ TDD å­¦ä¹ ä¹‹æ—…å§ï¼ğŸš€

---

**æ³¨æ„**: å»ºè®®å…ˆè‡ªå·±å°è¯•å®ç°ï¼Œé‡åˆ°å›°éš¾æ—¶å†æŸ¥çœ‹å‚è€ƒç­”æ¡ˆã€‚è¿™æ ·èƒ½å¤Ÿæœ€å¤§åŒ–å­¦ä¹ æ•ˆæœã€‚
